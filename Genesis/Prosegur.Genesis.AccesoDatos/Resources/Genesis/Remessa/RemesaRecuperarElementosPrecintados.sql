SELECT DISTINCT
  -- Cuenta
    CU.OID_CUENTA,
    CU.COD_TIPO_CUENTA,
    CU.GMT_CREACION AS GMT_CREACION_CUENTA,
    CU.DES_USUARIO_CREACION AS USUARIO_CREACION_CUENTA,
    CU.GMT_MODIFICACION AS GMT_MOD_CUENTA,
    CU.DES_USUARIO_MODIFICACION AS USUARIO_MOD_CUENTA, 
    CL.OID_CLIENTE, 
    CL.COD_CLIENTE,
    CL.DES_CLIENTE, 
    CL.BOL_ENVIADO_SALDOS AS CLIENTE_ENV_SALDOS,
    CL.BOL_TOTALIZADOR_SALDO AS CLIENTE_TOT_SALDOS,
    CL.BOL_VIGENTE AS CLIENTE_ACTIVO,
    SCL.OID_SUBCLIENTE,
    SCL.COD_SUBCLIENTE,
    SCL.DES_SUBCLIENTE,
    SCL.BOL_ENVIADO_SALDOS AS SUBCLIENTE_ENV_SALDOS,
    SCL.BOL_TOTALIZADOR_SALDO AS SUBCLIENTE_TOT_SALDOS,
    SCL.BOL_VIGENTE AS SUBCLIENTE_ACTIVO,
    PTO.OID_PTO_SERVICIO,
    PTO.COD_PTO_SERVICIO,
    PTO.DES_PTO_SERVICIO,
    PTO.BOL_ENVIADO_SALDOS AS PTO_ENV_SALDOS,
    PTO.BOL_TOTALIZADOR_SALDO AS PTO_TOT_SALDOS,
    PTO.BOL_VIGENTE AS PTO_ACTIVO,
    CAN.OID_CANAL,
    CAN.COD_CANAL,
    CAN.COD_MIGRACION AS MIGRACION_CANAL,
    CAN.COD_USUARIO AS USUARIO_CANAL,
    CAN.DES_CANAL, 
    CAN.BOL_VIGENTE AS CANAL_ACTIVO,
    CAN.FYH_ACTUALIZACION AS FYH_CANAL,
    CAN.OBS_CANAL,
    SBC.OID_SUBCANAL,
    SBC.COD_SUBCANAL,
    SBC.COD_MIGRACION AS MIGRACION_SUBCANAL,
    SBC.COD_USUARIO AS USUARIO_SUBCANAL,
    SBC.DES_SUBCANAL,
    SBC.BOL_VIGENTE AS SUBCANAL_ACTIVO, 
    SBC.FYH_ACTUALIZACION AS FYH_SUBCANAL,
    SBC.OBS_SUBCANAL,
    SE.OID_SECTOR,
    SE.COD_SECTOR,
    SE.COD_MIGRACION AS MIGRACION_SECTOR,
    SE.DES_SECTOR,
    SE.BOL_ACTIVO AS SECTOR_ACTIVO,
    SE.BOL_CENTRO_PROCESO,
    SE.BOL_CONTEO,
    SE.BOL_TESORO,
    SE.GMT_CREACION AS GMT_CREACION_SECTOR,
    SE.GMT_MODIFICACION AS GMT_MOD_SECTOR,
    SE.BOL_PERMITE_DISPONER_VALOR,
    SE.OID_TIPO_SECTOR,
    DEL.OID_DELEGACION,
    DEL.COD_DELEGACION,
    DEL.DES_DELEGACION, 
    DEL.COD_PAIS,
    DEL.BOL_VIGENTE AS DELEGACION_ACTIVA,
    PT.OID_PLANTA,
    PT.COD_PLANTA,
    PT.DES_PLANTA,
    PT.BOL_ACTIVO AS PLANTA_ACTIVA,
    
    -- Remesas
    R.OID_REMESA,
	R.OID_CUENTA AS R_OID_CUENTA,
	R.OID_CUENTA_SALDO AS R_OID_CUENTA_SALDO,
    R.COD_ESTADO AS R_COD_ESTADO,
    R.GMT_CREACION AS R_GMT_CREACION, 
    R.GMT_MODIFICACION AS R_GMT_MODIFICACION,       
    R.COD_PUESTO_RESPONSABLE AS R_COD_PUESTO_RESPONSABLE,
    R.DES_USUARIO_CREACION AS R_DES_USUARIO_CREACION,
    R.DES_USUARIO_MODIFICACION AS R_DES_USUARIO_MODIFICACION,
    R.COD_USUARIO_RESPONSABLE AS R_COD_USUARIO_RESPONSABLE,
    R.OID_IAC AS R_OID_IAC,
    R.COD_RUTA AS R_COD_RUTA,
    R.COD_RECIBO_SALIDA AS R_COD_RECIBO_SALIDA,
    R.OID_REMESA_ORIGEN AS R_OID_REMESA_ORIGEN,
    R.COD_EXTERNO AS R_COD_EXTERNO,
    R.OID_DOCUMENTO AS R_OID_DOCUMENTO,
    NULL  AS COD_ESTADO_DOCXELEMENTO_R,
    R.FYH_TRANSPORTE AS R_FYH_TRANSPORTE,
    R.NEL_PARADA AS R_NEL_PARADA,
    R.OID_EXTERNO AS R_OID_EXTERNO,
    R.COD_CAJERO AS R_COD_CAJERO,
    R.OID_REMESA_PADRE,
    R.FYH_CONTEO_INICIO R_FYH_CONTEO_INICIO,
    R.FYH_CONTEO_FIN R_FYH_CONTEO_FIN,
    R.BOL_GESTION_BULTO,
    R.BOL_ANULADO,
    R.BOL_NOENTREGUE,
    R.COD_NIVEL_DETALLE R_COD_NIVEL_DETALLE,

    -- Bultos
    B.OID_BULTO,
	B.OID_CUENTA AS B_OID_CUENTA,
	B.OID_CUENTA_SALDO AS B_OID_CUENTA_SALDO,
    B.COD_PRECINTO AS B_COD_PRECINTO,
    B.COD_ESTADO AS B_COD_ESTADO,
    B.GMT_CREACION AS B_GMT_CREACION, 
    B.GMT_MODIFICACION AS B_GMT_MODIFICACION,
    B.COD_PUESTO_RESPONSABLE AS B_COD_PUESTO_RESPONSABLE,       
    B.DES_USUARIO_CREACION AS B_DES_USUARIO_CREACION,
    B.DES_USUARIO_MODIFICACION AS B_DES_USUARIO_MODIFICACION,
    B.COD_USUARIO_RESPONSABLE AS B_COD_USUARIO_RESPONSABLE,
    B.OID_IAC AS B_OID_IAC,
    B.OID_IAC_PARCIALES AS B_OID_IAC_PARCIALES,
    B.OID_DOCUMENTO AS B_OID_DOCUMENTO,
    B.COD_BOLSA AS B_COD_BOLSA,
    B.OID_CUENTA AS B_OID_CUENTA,
    B.OID_EXTERNO AS B_OID_EXTERNO,
    B.OID_DOCUMENTO AS B_OID_DOCUMENTO,
    NULL AS COD_ESTADO_DOCXELEMENTO_B,
    B.FYH_PROCESO_LEGADO AS B_FYH_PROCESO_LEGADO,
    B.NEL_CANTIDAD_PARCIALES AS B_NEL_CANTIDAD_PARCIALES,
    B.BOL_CUADRADO AS BOL_CUADRADO,
    B.OID_BULTO_PADRE,
    B.FYH_CONTEO_INICIO B_FYH_CONTEO_INICIO,
    B.FYH_CONTEO_FIN B_FYH_CONTEO_FIN,
    B.COD_NIVEL_DETALLE B_COD_NIVEL_DETALLE,
    (SELECT LV1.COD_VALOR
    FROM SAPR_TLISTA_VALORXELEMENTO LVB1
    INNER JOIN GEPR_TLISTA_TIPO LT1 ON LT1.OID_LISTA_TIPO = LVB1.OID_LISTA_TIPO AND LT1.COD_TIPO = '01'
    INNER JOIN GEPR_TLISTA_VALOR LV1 ON LV1.OID_LISTA_VALOR = LVB1.OID_LISTA_VALOR
    WHERE LVB1.OID_BULTO = B.OID_BULTO AND rownum = 1) AS B_TipoUbicacion,
	 -- Parciales
    NULL AS OID_PARCIAL,
    NULL AS P_COD_PRECINTO,
    NULL AS P_COD_ESTADO,
    NULL AS P_COD_USUARIO_RESPONSABLE,
    NULL AS P_COD_PUESTO_RESPONSABLE,
    NULL AS P_NEC_SECUENCIA,
    NULL AS P_GMT_CREACION,
    NULL AS P_DES_USUARIO_CREACION,
    NULL AS P_GMT_MODIFICACION,
    NULL AS P_DES_USUARIO_MODIFICACION,
    NULL AS P_OID_IAC,
    NULL AS P_FYH_CONTEO_INICIO,
    NULL AS P_FYH_CONTEO_FIN,
	NULL AS P_OID_EXTERNO

FROM SAPR_TBULTO B
INNER JOIN SAPR_TREMESA R ON R.OID_REMESA = B.OID_REMESA
INNER JOIN SAPR_TCUENTA CU ON CU.OID_CUENTA = B.OID_CUENTA
INNER JOIN GEPR_TCLIENTE CL ON CL.OID_CLIENTE = CU.OID_CLIENTE
INNER JOIN GEPR_TSUBCANAL SBC ON SBC.OID_SUBCANAL = CU.OID_SUBCANAL
INNER JOIN GEPR_TCANAL CAN ON CAN.OID_CANAL = SBC.OID_CANAL
INNER JOIN GEPR_TSECTOR SE ON SE.OID_SECTOR = CU.OID_SECTOR
INNER JOIN GEPR_TPLANTA PT ON PT.OID_PLANTA = SE.OID_PLANTA
INNER JOIN GEPR_TDELEGACION DEL ON DEL.OID_DELEGACION = PT.OID_DELEGACION
LEFT JOIN GEPR_TSUBCLIENTE SCL ON SCL.OID_SUBCLIENTE = CU.OID_SUBCLIENTE
LEFT JOIN GEPR_TPUNTO_SERVICIO PTO ON PTO.OID_PTO_SERVICIO = CU.OID_PTO_SERVICIO
WHERE R.COD_ESTADO = []COD_ESTADO_REMESA
AND B.COD_ESTADO = []COD_ESTADO_BULTO 
AND DEL.COD_DELEGACION = []COD_DELEGACION 
AND PT.COD_PLANTA = []COD_PLANTA
{0}
ORDER BY R.OID_REMESA