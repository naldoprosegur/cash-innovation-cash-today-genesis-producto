CREATE OR REPLACE FUNCTION FN_SECTOR_PADRE_###VERSION### (P_LEVEL IN INT,P_OID_SECTOR_PADRE IN VARCHAR2,P_COD_SECTOR IN VARCHAR2,P_DES_SECTOR IN VARCHAR2)
  RETURN VARCHAR2
IS
 V_DES_SECTOR_PADRE VARCHAR2(320);
 V_OID_SECTOR_PADRE VARCHAR2(50);
BEGIN
  /*Version: ###VERSION_COMP###*/
  
  IF P_LEVEL =1 THEN
    V_DES_SECTOR_PADRE:=P_COD_SECTOR || ' - ' || P_DES_SECTOR;
  ELSE
    V_OID_SECTOR_PADRE:= P_OID_SECTOR_PADRE;
    
    FOR i IN 1..P_LEVEL-1
    LOOP
       SELECT OID_SECTOR_PADRE,COD_SECTOR || ' - ' || DES_SECTOR INTO V_OID_SECTOR_PADRE,V_DES_SECTOR_PADRE
       FROM GEPR_TSECTOR WHERE OID_SECTOR = V_OID_SECTOR_PADRE;
    END LOOP;
            
  END IF;  
  
  RETURN(V_DES_SECTOR_PADRE);
END FN_SECTOR_PADRE_###VERSION###;
/
